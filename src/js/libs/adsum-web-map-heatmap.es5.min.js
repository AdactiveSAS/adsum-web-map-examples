!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?exports.AHM=factory():root.AHM=factory()}(this,function(){return function(modules){function __webpack_require__(moduleId){if(!installedModules[moduleId]){var source=String(modules[moduleId]);for(var id in modules)if(id!==moduleId&&installedModules[id]&&String(modules[id])===source){installedModules[moduleId]=installedModules[id];break}}if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.HeatMap=exports.Options=void 0;var _Options=__webpack_require__(2),_Options2=_interopRequireDefault(_Options),_HeatMap=__webpack_require__(57),_HeatMap2=_interopRequireDefault(_HeatMap);exports.Options=_Options2["default"],exports.HeatMap=_HeatMap2["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(4),_createClass3=_interopRequireDefault(_createClass2),_weakMap=__webpack_require__(8),_weakMap2=_interopRequireDefault(_weakMap),_checkTypes=__webpack_require__(56),_checkTypes2=_interopRequireDefault(_checkTypes),_awm=new _weakMap2["default"],_data=new _weakMap2["default"],_floorId=new _weakMap2["default"],_mode=new _weakMap2["default"],_canvasSize=new _weakMap2["default"],_radius=new _weakMap2["default"],_max=new _weakMap2["default"],_z=new _weakMap2["default"],Options=function(){function Options(){(0,_classCallCheck3["default"])(this,Options),_awm.set(this,null),_data.set(this,null),_mode.set(this,null),_floorId.set(this,-99),_canvasSize.set(this,1024),_radius.set(this,10),_max.set(this,0),_z.set(this,null)}return(0,_createClass3["default"])(Options,[{key:"awm",get:function(){return _awm.get(this)},set:function(awm){return _checkTypes2["default"].assert.object(awm),_awm.set(this,awm)}},{key:"data",get:function(){return _data.get(this)},set:function(data){return _data.set(this,data)}},{key:"mode",get:function(){return _mode.get(this)},set:function(mode){return _checkTypes2["default"].assert.string(mode),_mode.set(this,mode)}},{key:"z",get:function(){return _z.get(this)},set:function(z){return _checkTypes2["default"].assert.number(z),_z.set(this,z)}},{key:"floorId",get:function(){return _floorId.get(this)},set:function(floorId){return _checkTypes2["default"].assert.number(floorId),_floorId.set(this,floorId)}},{key:"max",get:function(){return _max.get(this)},set:function(max){return _checkTypes2["default"].assert.number(max),_max.set(this,max)}},{key:"radius",get:function(){return _radius.get(this)},set:function(radius){return _checkTypes2["default"].assert.number(radius),_radius.set(this,radius)}},{key:"canvasSize",get:function(){return _canvasSize.get(this)},set:function(canvasSize){return _checkTypes2["default"].assert.number(canvasSize),_canvasSize.set(this,canvasSize)}}]),Options}();exports["default"]=Options},function(module,exports){"use strict";exports.__esModule=!0,exports["default"]=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}exports.__esModule=!0;var _defineProperty=__webpack_require__(5),_defineProperty2=_interopRequireDefault(_defineProperty);exports["default"]=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),(0,_defineProperty2["default"])(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}()},function(module,exports,__webpack_require__){module.exports={"default":__webpack_require__(6),__esModule:!0}},function(module,exports,__webpack_require__){var $=__webpack_require__(7);module.exports=function(it,key,desc){return $.setDesc(it,key,desc)}},function(module,exports){var $Object=Object;module.exports={create:$Object.create,getProto:$Object.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:$Object.getOwnPropertyDescriptor,setDesc:$Object.defineProperty,setDescs:$Object.defineProperties,getKeys:$Object.keys,getNames:$Object.getOwnPropertyNames,getSymbols:$Object.getOwnPropertySymbols,each:[].forEach}},function(module,exports,__webpack_require__){module.exports={"default":__webpack_require__(9),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(10),__webpack_require__(11),__webpack_require__(38),module.exports=__webpack_require__(24).WeakMap},function(module,exports){},function(module,exports,__webpack_require__){__webpack_require__(12);var Iterators=__webpack_require__(15);Iterators.NodeList=Iterators.HTMLCollection=Iterators.Array},function(module,exports,__webpack_require__){"use strict";var addToUnscopables=__webpack_require__(13),step=__webpack_require__(14),Iterators=__webpack_require__(15),toIObject=__webpack_require__(16);module.exports=__webpack_require__(20)(Array,"Array",function(iterated,kind){this._t=toIObject(iterated),this._i=0,this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;return!O||index>=O.length?(this._t=void 0,step(1)):"keys"==kind?step(0,index):"values"==kind?step(0,O[index]):step(0,[index,O[index]])},"values"),Iterators.Arguments=Iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries")},function(module,exports){module.exports=function(){}},function(module,exports){module.exports=function(done,value){return{value:value,done:!!done}}},function(module,exports){module.exports={}},function(module,exports,__webpack_require__){var IObject=__webpack_require__(17),defined=__webpack_require__(19);module.exports=function(it){return IObject(defined(it))}},function(module,exports,__webpack_require__){var cof=__webpack_require__(18);module.exports=Object("z").propertyIsEnumerable(0)?Object:function(it){return"String"==cof(it)?it.split(""):Object(it)}},function(module,exports){var toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1)}},function(module,exports){module.exports=function(it){if(void 0==it)throw TypeError("Can't call method on  "+it);return it}},function(module,exports,__webpack_require__){"use strict";var LIBRARY=__webpack_require__(21),$export=__webpack_require__(22),redefine=__webpack_require__(27),hide=__webpack_require__(28),has=__webpack_require__(32),Iterators=__webpack_require__(15),$iterCreate=__webpack_require__(33),setToStringTag=__webpack_require__(34),getProto=__webpack_require__(7).getProto,ITERATOR=__webpack_require__(35)("iterator"),BUGGY=!([].keys&&"next"in[].keys()),FF_ITERATOR="@@iterator",KEYS="keys",VALUES="values",returnThis=function(){return this};module.exports=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){$iterCreate(Constructor,NAME,next);var methods,key,getMethod=function(kind){if(!BUGGY&&kind in proto)return proto[kind];switch(kind){case KEYS:return function(){return new Constructor(this,kind)};case VALUES:return function(){return new Constructor(this,kind)}}return function(){return new Constructor(this,kind)}},TAG=NAME+" Iterator",DEF_VALUES=DEFAULT==VALUES,VALUES_BUG=!1,proto=Base.prototype,$native=proto[ITERATOR]||proto[FF_ITERATOR]||DEFAULT&&proto[DEFAULT],$default=$native||getMethod(DEFAULT);if($native){var IteratorPrototype=getProto($default.call(new Base));setToStringTag(IteratorPrototype,TAG,!0),!LIBRARY&&has(proto,FF_ITERATOR)&&hide(IteratorPrototype,ITERATOR,returnThis),DEF_VALUES&&$native.name!==VALUES&&(VALUES_BUG=!0,$default=function(){return $native.call(this)})}if(LIBRARY&&!FORCED||!BUGGY&&!VALUES_BUG&&proto[ITERATOR]||hide(proto,ITERATOR,$default),Iterators[NAME]=$default,Iterators[TAG]=returnThis,DEFAULT)if(methods={values:DEF_VALUES?$default:getMethod(VALUES),keys:IS_SET?$default:getMethod(KEYS),entries:DEF_VALUES?getMethod("entries"):$default},FORCED)for(key in methods)key in proto||redefine(proto,key,methods[key]);else $export($export.P+$export.F*(BUGGY||VALUES_BUG),NAME,methods);return methods}},function(module,exports){module.exports=!0},function(module,exports,__webpack_require__){var global=__webpack_require__(23),core=__webpack_require__(24),ctx=__webpack_require__(25),PROTOTYPE="prototype",$export=function(type,name,source){var key,own,out,IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,IS_WRAP=type&$export.W,exports=IS_GLOBAL?core:core[name]||(core[name]={}),target=IS_GLOBAL?global:IS_STATIC?global[name]:(global[name]||{})[PROTOTYPE];IS_GLOBAL&&(source=name);for(key in source)own=!IS_FORCED&&target&&key in target,own&&key in exports||(out=own?target[key]:source[key],exports[key]=IS_GLOBAL&&"function"!=typeof target[key]?source[key]:IS_BIND&&own?ctx(out,global):IS_WRAP&&target[key]==out?function(C){var F=function(param){return this instanceof C?new C(param):C(param)};return F[PROTOTYPE]=C[PROTOTYPE],F}(out):IS_PROTO&&"function"==typeof out?ctx(Function.call,out):out,IS_PROTO&&((exports[PROTOTYPE]||(exports[PROTOTYPE]={}))[key]=out))};$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,module.exports=$export},function(module,exports){var global=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=global)},function(module,exports){var core=module.exports={version:"1.2.6"};"number"==typeof __e&&(__e=core)},function(module,exports,__webpack_require__){var aFunction=__webpack_require__(26);module.exports=function(fn,that,length){if(aFunction(fn),void 0===that)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}},function(module,exports){module.exports=function(it){if("function"!=typeof it)throw TypeError(it+" is not a function!");return it}},function(module,exports,__webpack_require__){module.exports=__webpack_require__(28)},function(module,exports,__webpack_require__){var $=__webpack_require__(7),createDesc=__webpack_require__(29);module.exports=__webpack_require__(30)?function(object,key,value){return $.setDesc(object,key,createDesc(1,value))}:function(object,key,value){return object[key]=value,object}},function(module,exports){module.exports=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}}},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(31)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(module,exports){module.exports=function(exec){try{return!!exec()}catch(e){return!0}}},function(module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(7),descriptor=__webpack_require__(29),setToStringTag=__webpack_require__(34),IteratorPrototype={};__webpack_require__(28)(IteratorPrototype,__webpack_require__(35)("iterator"),function(){return this}),module.exports=function(Constructor,NAME,next){Constructor.prototype=$.create(IteratorPrototype,{next:descriptor(1,next)}),setToStringTag(Constructor,NAME+" Iterator")}},function(module,exports,__webpack_require__){var def=__webpack_require__(7).setDesc,has=__webpack_require__(32),TAG=__webpack_require__(35)("toStringTag");module.exports=function(it,tag,stat){it&&!has(it=stat?it:it.prototype,TAG)&&def(it,TAG,{configurable:!0,value:tag})}},function(module,exports,__webpack_require__){var store=__webpack_require__(36)("wks"),uid=__webpack_require__(37),Symbol=__webpack_require__(23).Symbol;module.exports=function(name){return store[name]||(store[name]=Symbol&&Symbol[name]||(Symbol||uid)("Symbol."+name))}},function(module,exports,__webpack_require__){var global=__webpack_require__(23),SHARED="__core-js_shared__",store=global[SHARED]||(global[SHARED]={});module.exports=function(key){return store[key]||(store[key]={})}},function(module,exports){var id=0,px=Math.random();module.exports=function(key){return"Symbol(".concat(void 0===key?"":key,")_",(++id+px).toString(36))}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(7),redefine=__webpack_require__(27),weak=__webpack_require__(39),isObject=__webpack_require__(42),has=__webpack_require__(32),frozenStore=weak.frozenStore,WEAK=weak.WEAK,isExtensible=Object.isExtensible||isObject,tmp={},$WeakMap=__webpack_require__(55)("WeakMap",function(get){return function(){return get(this,arguments.length>0?arguments[0]:void 0)}},{get:function(key){if(isObject(key)){if(!isExtensible(key))return frozenStore(this).get(key);if(has(key,WEAK))return key[WEAK][this._i]}},set:function(key,value){return weak.def(this,key,value)}},weak,!0,!0);7!=(new $WeakMap).set((Object.freeze||Object)(tmp),7).get(tmp)&&$.each.call(["delete","has","get","set"],function(key){var proto=$WeakMap.prototype,method=proto[key];redefine(proto,key,function(a,b){if(isObject(a)&&!isExtensible(a)){var result=frozenStore(this)[key](a,b);return"set"==key?this:result}return method.call(this,a,b)})})},function(module,exports,__webpack_require__){"use strict";var hide=__webpack_require__(28),redefineAll=__webpack_require__(40),anObject=__webpack_require__(41),isObject=__webpack_require__(42),strictNew=__webpack_require__(43),forOf=__webpack_require__(44),createArrayMethod=__webpack_require__(51),$has=__webpack_require__(32),WEAK=__webpack_require__(37)("weak"),isExtensible=Object.isExtensible||isObject,arrayFind=createArrayMethod(5),arrayFindIndex=createArrayMethod(6),id=0,frozenStore=function(that){return that._l||(that._l=new FrozenStore)},FrozenStore=function(){this.a=[]},findFrozen=function(store,key){return arrayFind(store.a,function(it){return it[0]===key})};FrozenStore.prototype={get:function(key){var entry=findFrozen(this,key);if(entry)return entry[1]},has:function(key){return!!findFrozen(this,key)},set:function(key,value){var entry=findFrozen(this,key);entry?entry[1]=value:this.a.push([key,value])},"delete":function(key){var index=arrayFindIndex(this.a,function(it){return it[0]===key});return~index&&this.a.splice(index,1),!!~index}},module.exports={getConstructor:function(wrapper,NAME,IS_MAP,ADDER){var C=wrapper(function(that,iterable){strictNew(that,C,NAME),that._i=id++,that._l=void 0,void 0!=iterable&&forOf(iterable,IS_MAP,that[ADDER],that)});return redefineAll(C.prototype,{"delete":function(key){return!!isObject(key)&&(isExtensible(key)?$has(key,WEAK)&&$has(key[WEAK],this._i)&&delete key[WEAK][this._i]:frozenStore(this)["delete"](key))},has:function(key){return!!isObject(key)&&(isExtensible(key)?$has(key,WEAK)&&$has(key[WEAK],this._i):frozenStore(this).has(key))}}),C},def:function(that,key,value){return isExtensible(anObject(key))?($has(key,WEAK)||hide(key,WEAK,{}),key[WEAK][that._i]=value):frozenStore(that).set(key,value),that},frozenStore:frozenStore,WEAK:WEAK}},function(module,exports,__webpack_require__){var redefine=__webpack_require__(27);module.exports=function(target,src){for(var key in src)redefine(target,key,src[key]);return target}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(42);module.exports=function(it){if(!isObject(it))throw TypeError(it+" is not an object!");return it}},function(module,exports){module.exports=function(it){return"object"==typeof it?null!==it:"function"==typeof it}},function(module,exports){module.exports=function(it,Constructor,name){if(!(it instanceof Constructor))throw TypeError(name+": use the 'new' operator!");return it}},function(module,exports,__webpack_require__){var ctx=__webpack_require__(25),call=__webpack_require__(45),isArrayIter=__webpack_require__(46),anObject=__webpack_require__(41),toLength=__webpack_require__(47),getIterFn=__webpack_require__(49);module.exports=function(iterable,entries,fn,that){var length,step,iterator,iterFn=getIterFn(iterable),f=ctx(fn,that,entries?2:1),index=0;if("function"!=typeof iterFn)throw TypeError(iterable+" is not iterable!");if(isArrayIter(iterFn))for(length=toLength(iterable.length);length>index;index++)entries?f(anObject(step=iterable[index])[0],step[1]):f(iterable[index]);else for(iterator=iterFn.call(iterable);!(step=iterator.next()).done;)call(iterator,f,step.value,entries)}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(41);module.exports=function(iterator,fn,value,entries){try{return entries?fn(anObject(value)[0],value[1]):fn(value)}catch(e){var ret=iterator["return"];throw void 0!==ret&&anObject(ret.call(iterator)),e}}},function(module,exports,__webpack_require__){var Iterators=__webpack_require__(15),ITERATOR=__webpack_require__(35)("iterator"),ArrayProto=Array.prototype;module.exports=function(it){return void 0!==it&&(Iterators.Array===it||ArrayProto[ITERATOR]===it)}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(48),min=Math.min;module.exports=function(it){return it>0?min(toInteger(it),9007199254740991):0}},function(module,exports){var ceil=Math.ceil,floor=Math.floor;module.exports=function(it){return isNaN(it=+it)?0:(it>0?floor:ceil)(it)}},function(module,exports,__webpack_require__){var classof=__webpack_require__(50),ITERATOR=__webpack_require__(35)("iterator"),Iterators=__webpack_require__(15);module.exports=__webpack_require__(24).getIteratorMethod=function(it){if(void 0!=it)return it[ITERATOR]||it["@@iterator"]||Iterators[classof(it)]}},function(module,exports,__webpack_require__){var cof=__webpack_require__(18),TAG=__webpack_require__(35)("toStringTag"),ARG="Arguments"==cof(function(){return arguments}());module.exports=function(it){var O,T,B;return void 0===it?"Undefined":null===it?"Null":"string"==typeof(T=(O=Object(it))[TAG])?T:ARG?cof(O):"Object"==(B=cof(O))&&"function"==typeof O.callee?"Arguments":B}},function(module,exports,__webpack_require__){var ctx=__webpack_require__(25),IObject=__webpack_require__(17),toObject=__webpack_require__(52),toLength=__webpack_require__(47),asc=__webpack_require__(53);module.exports=function(TYPE){var IS_MAP=1==TYPE,IS_FILTER=2==TYPE,IS_SOME=3==TYPE,IS_EVERY=4==TYPE,IS_FIND_INDEX=6==TYPE,NO_HOLES=5==TYPE||IS_FIND_INDEX;return function($this,callbackfn,that){for(var val,res,O=toObject($this),self=IObject(O),f=ctx(callbackfn,that,3),length=toLength(self.length),index=0,result=IS_MAP?asc($this,length):IS_FILTER?asc($this,0):void 0;length>index;index++)if((NO_HOLES||index in self)&&(val=self[index],res=f(val,index,O),TYPE))if(IS_MAP)result[index]=res;else if(res)switch(TYPE){case 3:return!0;case 5:return val;case 6:return index;case 2:result.push(val)}else if(IS_EVERY)return!1;return IS_FIND_INDEX?-1:IS_SOME||IS_EVERY?IS_EVERY:result}}},function(module,exports,__webpack_require__){var defined=__webpack_require__(19);module.exports=function(it){return Object(defined(it))}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(42),isArray=__webpack_require__(54),SPECIES=__webpack_require__(35)("species");module.exports=function(original,length){var C;return isArray(original)&&(C=original.constructor,"function"!=typeof C||C!==Array&&!isArray(C.prototype)||(C=void 0),isObject(C)&&(C=C[SPECIES],null===C&&(C=void 0))),new(void 0===C?Array:C)(length)}},function(module,exports,__webpack_require__){var cof=__webpack_require__(18);module.exports=Array.isArray||function(arg){return"Array"==cof(arg)}},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(7),global=__webpack_require__(23),$export=__webpack_require__(22),fails=__webpack_require__(31),hide=__webpack_require__(28),redefineAll=__webpack_require__(40),forOf=__webpack_require__(44),strictNew=__webpack_require__(43),isObject=__webpack_require__(42),setToStringTag=__webpack_require__(34),DESCRIPTORS=__webpack_require__(30);module.exports=function(NAME,wrapper,methods,common,IS_MAP,IS_WEAK){var Base=global[NAME],C=Base,ADDER=IS_MAP?"set":"add",proto=C&&C.prototype,O={};return DESCRIPTORS&&"function"==typeof C&&(IS_WEAK||proto.forEach&&!fails(function(){(new C).entries().next()}))?(C=wrapper(function(target,iterable){strictNew(target,C,NAME),target._c=new Base,void 0!=iterable&&forOf(iterable,IS_MAP,target[ADDER],target)}),$.each.call("add,clear,delete,forEach,get,has,set,keys,values,entries".split(","),function(KEY){var IS_ADDER="add"==KEY||"set"==KEY;KEY in proto&&(!IS_WEAK||"clear"!=KEY)&&hide(C.prototype,KEY,function(a,b){if(!IS_ADDER&&IS_WEAK&&!isObject(a))return"get"==KEY&&void 0;var result=this._c[KEY](0===a?0:a,b);return IS_ADDER?this:result})}),"size"in proto&&$.setDesc(C.prototype,"size",{get:function(){return this._c.size}})):(C=common.getConstructor(wrapper,NAME,IS_MAP,ADDER),redefineAll(C.prototype,methods)),setToStringTag(C,NAME),O[NAME]=C,$export($export.G+$export.W+$export.F,O),IS_WEAK||common.setStrong(C,NAME,IS_MAP),C}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(globals){"use strict";function equal(lhs,rhs){return lhs===rhs}function isUndefined(data){return void 0===data}function isNull(data){return null===data}function assigned(data){return!isUndefined(data)&&!isNull(data)}function zero(data){return 0===data}function infinity(data){return data===Number.POSITIVE_INFINITY||data===Number.NEGATIVE_INFINITY}function number(data){return"number"==typeof data&&isNaN(data)===!1&&data!==Number.POSITIVE_INFINITY&&data!==Number.NEGATIVE_INFINITY}function integer(data){return number(data)&&data%1===0}function even(data){return number(data)&&data%2===0}function odd(data){return integer(data)&&!even(data)}function greater(lhs,rhs){return number(lhs)&&lhs>rhs}function less(lhs,rhs){return number(lhs)&&lhs<rhs}function between(data,x,y){return x<y?greater(data,x)&&less(data,y):less(data,x)&&greater(data,y)}function greaterOrEqual(lhs,rhs){return number(lhs)&&lhs>=rhs}function lessOrEqual(lhs,rhs){return number(lhs)&&lhs<=rhs}function inRange(data,x,y){return x<y?greaterOrEqual(data,x)&&lessOrEqual(data,y):lessOrEqual(data,x)&&greaterOrEqual(data,y)}function positive(data){return greater(data,0)}function negative(data){return less(data,0)}function string(data){return"string"==typeof data}function emptyString(data){return""===data}function nonEmptyString(data){return string(data)&&""!==data}function contains(data,substring){return string(data)&&data.indexOf(substring)!==-1}function match(data,regex){return string(data)&&!!data.match(regex)}function boolean(data){return data===!1||data===!0}function object(data){return"[object Object]"===Object.prototype.toString.call(data)}function emptyObject(data){return object(data)&&0===Object.keys(data).length}function instance(data,prototype){try{return data instanceof prototype}catch(error){return!1}}function builtIn(data,prototype){try{return instance(data,prototype)||Object.prototype.toString.call(data)==="[object "+prototype.name+"]"}catch(error){return!1}}function userDefined(data,prototype){try{return instance(data,prototype)||data.constructor.name===prototype.name}catch(error){return!1}}function like(data,archetype){var name;for(name in archetype)if(archetype.hasOwnProperty(name)){if(data.hasOwnProperty(name)===!1||typeof data[name]!=typeof archetype[name])return!1;if(object(data[name])&&like(data[name],archetype[name])===!1)return!1}return!0}function array(data){return Array.isArray(data)}function emptyArray(data){return array(data)&&0===data.length}function arrayLike(data){return assigned(data)&&number(data.length)}function iterable(data){return"undefined"==typeof Symbol?arrayLike(data):assigned(data)&&isFunction(data[Symbol.iterator])}function includes(data,value){var iterator,iteration;if(not.assigned(data))return!1;try{if("undefined"!=typeof Symbol&&data[Symbol.iterator]&&isFunction(data.values)){iterator=data.values();do if(iteration=iterator.next(),iteration.value===value)return!0;while(!iteration.done);return!1}Object.keys(data).forEach(function(key){if(data[key]===value)throw 0})}catch(ignore){return!0}return!1}function hasLength(data,length){return assigned(data)&&data.length===length}function date(data){return builtIn(data,Date)&&!isNaN(data.getTime())}function isFunction(data){return"function"==typeof data}function apply(data,predicates){return assert.array(data),isFunction(predicates)?data.map(function(value){return predicates(value)}):(assert.array(predicates),assert.hasLength(data,predicates.length),data.map(function(value,index){return predicates[index](value)}))}function map(data,predicates){return assert.object(data),isFunction(predicates)?mapSimple(data,predicates):(assert.object(predicates),mapComplex(data,predicates))}function mapSimple(data,predicate){var result={};return Object.keys(data).forEach(function(key){result[key]=predicate(data[key])}),result}function mapComplex(data,predicates){var result={};return Object.keys(predicates).forEach(function(key){var predicate=predicates[key];isFunction(predicate)?not.assigned(data)?result[key]=!!predicate._isMaybefied:result[key]=predicate(data[key]):object(predicate)&&(result[key]=mapComplex(data[key],predicate))}),result}function all(data){return array(data)?testArray(data,!1):(assert.object(data),testObject(data,!1))}function testArray(data,result){var i;for(i=0;i<data.length;i+=1)if(data[i]===result)return result;return!result}function testObject(data,result){var key,value;for(key in data)if(data.hasOwnProperty(key)){if(value=data[key],object(value)&&testObject(value,result)===result)return result;if(value===result)return result}return!result}function any(data){return array(data)?testArray(data,!0):(assert.object(data),testObject(data,!0))}function mixin(target,source){return Object.keys(source).forEach(function(key){target[key]=source[key]}),target}function assertModifier(predicate,defaultMessage){return function(){assertPredicate(predicate,arguments,defaultMessage)}}function assertPredicate(predicate,args,defaultMessage){var message=args[args.length-1];assertImpl(predicate.apply(null,args),nonEmptyString(message)?message:defaultMessage)}function assertImpl(value,message){if(value===!1)throw new Error(message||"Assertion failed")}function notModifier(predicate){return function(){return notImpl(predicate.apply(null,arguments))}}function notImpl(value){return!value}function maybeModifier(predicate){var modifiedPredicate=function(){return!!not.assigned(arguments[0])||predicate.apply(null,arguments)};return modifiedPredicate._isMaybefied=!0,modifiedPredicate}function maybeImpl(value){return assigned(value)===!1||value}function ofModifier(target,type,predicate){return function(){var collection,args;if(collection=arguments[0],"maybe"===target&&not.assigned(collection))return!0;if(!type(collection))return!1;collection=coerceCollection(type,collection),args=slice.call(arguments,1);try{collection.forEach(function(item){if(("maybe"!==target||assigned(item))&&!predicate.apply(null,[item].concat(args)))throw 0})}catch(ignore){return!1}return!0}}function coerceCollection(type,collection){switch(type){case arrayLike:return slice.call(collection);case object:return Object.keys(collection).map(function(key){return collection[key]});default:return collection}}function createModifiedPredicates(modifier,object){return createModifiedFunctions([modifier,predicates,object])}function createModifiedFunctions(args){var modifier,object,functions,result;return modifier=args.shift(),object=args.pop(),functions=args.pop(),result=object||{},Object.keys(functions).forEach(function(key){Object.defineProperty(result,key,{configurable:!1,enumerable:!0,writable:!1,value:modifier.apply(null,args.concat(functions[key],messages[key]))})}),result}function createModifiedModifier(modifier,modified){return createModifiedFunctions([modifier,modified,null])}function createOfPredicates(key){predicates[key].of=createModifiedFunctions([ofModifier.bind(null,null),predicates[key],predicates,null])}function createOfModifiers(base,modifier){collections.forEach(function(key){base[key].of=createModifiedModifier(modifier,predicates[key].of)})}function createMaybeOfModifiers(key){maybe[key].of=createModifiedFunctions([ofModifier.bind(null,"maybe"),predicates[key],predicates,null]),assert.maybe[key].of=createModifiedModifier(assertModifier,maybe[key].of),assert.not[key].of=createModifiedModifier(assertModifier,not[key].of)}function exportFunctions(functions){__WEBPACK_AMD_DEFINE_RESULT__=function(){return functions}.call(exports,__webpack_require__,exports,module),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}var strings,messages,predicates,functions,assert,not,maybe,collections,slice;strings={v:"value",n:"number",s:"string",b:"boolean",o:"object",t:"type",a:"array",al:"array-like",i:"iterable",d:"date",f:"function",l:"length"},messages={},predicates={},[{n:"equal",f:equal,s:"v"},{n:"undefined",f:isUndefined,s:"v"},{n:"null",f:isNull,s:"v"},{n:"assigned",f:assigned,s:"v"},{n:"includes",f:includes,s:"v"},{n:"zero",f:zero,s:"n"},{n:"infinity",f:infinity,s:"n"},{n:"number",f:number,s:"n"},{n:"integer",f:integer,s:"n"},{n:"even",f:even,s:"n"},{n:"odd",f:odd,s:"n"},{n:"greater",f:greater,s:"n"},{n:"less",f:less,s:"n"},{n:"between",f:between,s:"n"},{n:"greaterOrEqual",f:greaterOrEqual,s:"n"},{n:"lessOrEqual",f:lessOrEqual,s:"n"},{n:"inRange",f:inRange,s:"n"},{n:"positive",f:positive,s:"n"},{n:"negative",f:negative,s:"n"},{n:"string",f:string,s:"s"},{n:"emptyString",f:emptyString,s:"s"},{n:"nonEmptyString",f:nonEmptyString,s:"s"},{n:"contains",f:contains,s:"s"},{n:"match",f:match,s:"s"},{n:"boolean",f:boolean,s:"b"},{n:"object",f:object,s:"o"},{n:"emptyObject",f:emptyObject,s:"o"},{n:"instance",f:instance,s:"t"},{n:"builtIn",f:builtIn,s:"t"},{n:"userDefined",f:userDefined,s:"t"},{n:"like",f:like,s:"t"},{n:"array",f:array,s:"a"},{n:"emptyArray",f:emptyArray,s:"a"},{n:"arrayLike",f:arrayLike,s:"al"},{n:"iterable",f:iterable,s:"i"},{n:"date",f:date,s:"d"},{n:"function",f:isFunction,s:"f"},{n:"hasLength",f:hasLength,s:"l"}].map(function(data){messages[data.n]="Invalid "+strings[data.s],predicates[data.n]=data.f}),functions={apply:apply,map:map,all:all,any:any},collections=["array","arrayLike","iterable","object"],slice=Array.prototype.slice,functions=mixin(functions,predicates),assert=createModifiedPredicates(assertModifier,assertImpl),not=createModifiedPredicates(notModifier,notImpl),maybe=createModifiedPredicates(maybeModifier,maybeImpl),assert.not=createModifiedModifier(assertModifier,not),assert.maybe=createModifiedModifier(assertModifier,maybe),collections.forEach(createOfPredicates),createOfModifiers(assert,assertModifier),createOfModifiers(not,notModifier),collections.forEach(createMaybeOfModifiers),exportFunctions(mixin(functions,{assert:assert,not:not,maybe:maybe}))}(this)},function(module,exports,__webpack_require__){
"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof2=__webpack_require__(58),_typeof3=_interopRequireDefault(_typeof2),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(4),_createClass3=_interopRequireDefault(_createClass2),_weakMap=__webpack_require__(8),_weakMap2=_interopRequireDefault(_weakMap),_checkTypes=__webpack_require__(56),_checkTypes2=_interopRequireDefault(_checkTypes),_Options=__webpack_require__(2),_Options2=_interopRequireDefault(_Options),_heatmap=__webpack_require__(65),_heatmap2=_interopRequireDefault(_heatmap),_options=new _weakMap2["default"],defaultOptions={awm:{},data:null,mode:"",floorId:-99,canvasSize:1024,radius:10,max:0,z:0},HeatMap=function(){function HeatMap(options){(0,_classCallCheck3["default"])(this,HeatMap);var heatMapOptions=new _Options2["default"];heatMapOptions.awm=this._getOption(options,"awm"),heatMapOptions.data=this._getOption(options,"data"),heatMapOptions.floorId=this._getOption(options,"floorId"),heatMapOptions.radius=this._getOption(options,"radius"),heatMapOptions.mode=this._getOption(options,"mode"),heatMapOptions.canvasSize=this._getOption(options,"canvasSize"),heatMapOptions.max=this._getOption(options,"max"),heatMapOptions.z=this._getOption(options,"z"),this.options=heatMapOptions,this._heatMapInstance=null,this._heatMapCanvas=null,this._heatMapMesh=null,this._heatMapTexture=null,this._heatMapMaterial=null,this._floorMesh=null,this._floorGeometry=null,this._rendered=!1}return(0,_createClass3["default"])(HeatMap,[{key:"_getOption",value:function(options,key){return"object"===("undefined"==typeof options?"undefined":(0,_typeof3["default"])(options))&&options.hasOwnProperty(key)?options[key]:defaultOptions[key]}},{key:"getDefaultOptions",value:function(){return defaultOptions}},{key:"_clarityMode",value:function(){for(var em=this.options.awm.dataManager._entityManager,places=em.getRepository("Place").getAll(),i=0;i<places.length;i++)if(places[i].shape_id){this.options.awm.mapManager.setShapeColor(places[i].shape_id,13421772);var shape=this.options.awm.mapManager._shapeController.getById(places[i].shape_id);shape.material.transparent=!0,shape.material.opacity=.9}for(var customObjects=em.getRepository("CustomObject").getAll(),i=0;i<customObjects.length;i++)this.options.awm.mapManager.setCustomObjectAlwaysVisible(customObjects[i].id,!1),this.options.awm.mapManager.setCustomObjectVisibility(customObjects[i].id,!1)}},{key:"_getFloorMesh",value:function(floorId){var floorMesh=null;if(this.options.awm.mapManager._floorController.getById(floorId)instanceof AWM.THREE.Mesh)floorMesh=this.options.awm.mapManager._floorController.getById(floorId);else{if(!(this.options.awm.mapManager._floorController.getById(floorId).getFloorMesh()instanceof AWM.THREE.Mesh))throw new Error("The floor mesh cannot be accessed");floorMesh=this.options.awm.mapManager._floorController.getById(floorId).getFloorMesh()}return floorMesh}},{key:"_convertCoordinate",value:function(position,floorMesh){var raycaster=new AWM.THREE.Raycaster,worldPos=floorMesh.localToWorld(position.clone()),origin=worldPos.clone();origin.z+=this.options.z+100,raycaster.set(origin,new AWM.THREE.Vector3(0,0,(-1)));var intersects=raycaster.intersectObjects([floorMesh]);if(intersects.length>0){var uv=intersects[0].uv;return intersects[0].object.material.map.transformUv(uv),{x:Math.floor(uv.x*this.options.canvasSize),y:Math.floor(uv.y*this.options.canvasSize)}}return console.error("Coordinates doesn't exist : ",position),null}},{key:"setFloor",value:function(floorId){this.options.floorId=floorId,this._floorMesh=this._getFloorMesh(this.options.floorId),this._floorGeometry=this._floorMesh.geometry,this._floorGeometry.computeBoundingBox()}},{key:"clearData",value:function(){this._heatMapInstance.setData({max:0,data:{}}),this._heatMapInstance.repaint()}},{key:"clear",value:function(){return null!==this._heatMapInstance&&null!==this._floorMesh&&null!==this._heatMapMesh&&(this._floorMesh.remove(this._heatMapMesh),this._rendered=!1),this}},{key:"setDataMax",value:function(max){this.options.max=max,this._heatMapInstance.setDataMax(this.options.max)}},{key:"setRadius",value:function(radius){return this.options.radius=radius,this.clear(),document.getElementById(this.options.awm._options.container).removeChild(document.getElementById("heatmap")),this.init()}},{key:"setData",value:function(dataIn){var _this=this;return null!==this._heatMapInstance&&null!==this._floorMesh&&!function(){var data=[];dataIn.data.forEach(function(point){var newPoint={};newPoint=_this._convertCoordinate(point.position,_this._floorMesh),null!==newPoint&&(newPoint.value=point.value,data.push(newPoint))}),_this.options.max=dataIn.max,_this.options.data=dataIn.data,_this._heatMapInstance.setData({max:_this.options.max,data:data}),_this._heatMapInstance.repaint()}(),this}},{key:"_createHeatMapMesh",value:function(){if(this.options.floorId===-99||null===this._floorMesh)throw new error("You must set a floor");this._heatMapTexture=new AWM.THREE.Texture(this._heatMapCanvas),this._heatMapTexture.needsUpdate=!0,this._heatMapMaterial=new AWM.THREE.MeshBasicMaterial({map:this._heatMapTexture,side:AWM.THREE.DoubleSide}),this._heatMapMaterial.transparent=!0,this._heatMapMesh=new AWM.THREE.Mesh(this._floorGeometry.clone(),this._heatMapMaterial),this._heatMapMesh.position.z=this.options.z,this._floorMesh.add(this._heatMapMesh)}},{key:"init",value:function(){var mapContainer=document.getElementById(this.options.awm._options.container),heatmap=document.createElement("div");switch(heatmap.id="heatmap",heatmap.style.display="none",heatmap.style.width=this.options.canvasSize+"px",heatmap.style.height=this.options.canvasSize+"px",mapContainer.appendChild(heatmap),this._heatMapInstance=_heatmap2["default"].create({container:document.getElementById("heatmap"),radius:this.options.radius}),this._heatMapCanvas=document.getElementById("heatmap").childNodes[0],this.options.mode){case"clarity":this._clarityMode()}return this.options.floorId!==-99&&(this.setFloor(this.options.floorId),null!==this.options.data&&0!==this.options.max&&this.setData({max:this.options.max,data:this.options.data})),this}},{key:"render",value:function(){return this._rendered||(this._rendered=!0,this._createHeatMapMesh()),this}},{key:"options",get:function(){return _options.get(this)},set:function(options){return _checkTypes2["default"].assert.instance(options,_Options2["default"]),_options.set(this,options)}}]),HeatMap}();exports["default"]=HeatMap},function(module,exports,__webpack_require__){"use strict";var _Symbol=__webpack_require__(59)["default"];exports["default"]=function(obj){return obj&&obj.constructor===_Symbol?"symbol":typeof obj},exports.__esModule=!0},function(module,exports,__webpack_require__){module.exports={"default":__webpack_require__(60),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(61),__webpack_require__(10),module.exports=__webpack_require__(24).Symbol},function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(7),global=__webpack_require__(23),has=__webpack_require__(32),DESCRIPTORS=__webpack_require__(30),$export=__webpack_require__(22),redefine=__webpack_require__(27),$fails=__webpack_require__(31),shared=__webpack_require__(36),setToStringTag=__webpack_require__(34),uid=__webpack_require__(37),wks=__webpack_require__(35),keyOf=__webpack_require__(62),$names=__webpack_require__(63),enumKeys=__webpack_require__(64),isArray=__webpack_require__(54),anObject=__webpack_require__(41),toIObject=__webpack_require__(16),createDesc=__webpack_require__(29),getDesc=$.getDesc,setDesc=$.setDesc,_create=$.create,getNames=$names.get,$Symbol=global.Symbol,$JSON=global.JSON,_stringify=$JSON&&$JSON.stringify,setter=!1,HIDDEN=wks("_hidden"),isEnum=$.isEnum,SymbolRegistry=shared("symbol-registry"),AllSymbols=shared("symbols"),useNative="function"==typeof $Symbol,ObjectProto=Object.prototype,setSymbolDesc=DESCRIPTORS&&$fails(function(){return 7!=_create(setDesc({},"a",{get:function(){return setDesc(this,"a",{value:7}).a}})).a})?function(it,key,D){var protoDesc=getDesc(ObjectProto,key);protoDesc&&delete ObjectProto[key],setDesc(it,key,D),protoDesc&&it!==ObjectProto&&setDesc(ObjectProto,key,protoDesc)}:setDesc,wrap=function(tag){var sym=AllSymbols[tag]=_create($Symbol.prototype);return sym._k=tag,DESCRIPTORS&&setter&&setSymbolDesc(ObjectProto,tag,{configurable:!0,set:function(value){has(this,HIDDEN)&&has(this[HIDDEN],tag)&&(this[HIDDEN][tag]=!1),setSymbolDesc(this,tag,createDesc(1,value))}}),sym},isSymbol=function(it){return"symbol"==typeof it},$defineProperty=function(it,key,D){return D&&has(AllSymbols,key)?(D.enumerable?(has(it,HIDDEN)&&it[HIDDEN][key]&&(it[HIDDEN][key]=!1),D=_create(D,{enumerable:createDesc(0,!1)})):(has(it,HIDDEN)||setDesc(it,HIDDEN,createDesc(1,{})),it[HIDDEN][key]=!0),setSymbolDesc(it,key,D)):setDesc(it,key,D)},$defineProperties=function(it,P){anObject(it);for(var key,keys=enumKeys(P=toIObject(P)),i=0,l=keys.length;l>i;)$defineProperty(it,key=keys[i++],P[key]);return it},$create=function(it,P){return void 0===P?_create(it):$defineProperties(_create(it),P)},$propertyIsEnumerable=function(key){var E=isEnum.call(this,key);return!(E||!has(this,key)||!has(AllSymbols,key)||has(this,HIDDEN)&&this[HIDDEN][key])||E},$getOwnPropertyDescriptor=function(it,key){var D=getDesc(it=toIObject(it),key);return!D||!has(AllSymbols,key)||has(it,HIDDEN)&&it[HIDDEN][key]||(D.enumerable=!0),D},$getOwnPropertyNames=function(it){for(var key,names=getNames(toIObject(it)),result=[],i=0;names.length>i;)has(AllSymbols,key=names[i++])||key==HIDDEN||result.push(key);return result},$getOwnPropertySymbols=function(it){for(var key,names=getNames(toIObject(it)),result=[],i=0;names.length>i;)has(AllSymbols,key=names[i++])&&result.push(AllSymbols[key]);return result},$stringify=function(it){if(void 0!==it&&!isSymbol(it)){for(var replacer,$replacer,args=[it],i=1,$$=arguments;$$.length>i;)args.push($$[i++]);return replacer=args[1],"function"==typeof replacer&&($replacer=replacer),!$replacer&&isArray(replacer)||(replacer=function(key,value){if($replacer&&(value=$replacer.call(this,key,value)),!isSymbol(value))return value}),args[1]=replacer,_stringify.apply($JSON,args)}},buggyJSON=$fails(function(){var S=$Symbol();return"[null]"!=_stringify([S])||"{}"!=_stringify({a:S})||"{}"!=_stringify(Object(S))});useNative||($Symbol=function(){if(isSymbol(this))throw TypeError("Symbol is not a constructor");return wrap(uid(arguments.length>0?arguments[0]:void 0))},redefine($Symbol.prototype,"toString",function(){return this._k}),isSymbol=function(it){return it instanceof $Symbol},$.create=$create,$.isEnum=$propertyIsEnumerable,$.getDesc=$getOwnPropertyDescriptor,$.setDesc=$defineProperty,$.setDescs=$defineProperties,$.getNames=$names.get=$getOwnPropertyNames,$.getSymbols=$getOwnPropertySymbols,DESCRIPTORS&&!__webpack_require__(21)&&redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable,!0));var symbolStatics={"for":function(key){return has(SymbolRegistry,key+="")?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function(key){return keyOf(SymbolRegistry,key)},useSetter:function(){setter=!0},useSimple:function(){setter=!1}};$.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(it){var sym=wks(it);symbolStatics[it]=useNative?sym:wrap(sym)}),setter=!0,$export($export.G+$export.W,{Symbol:$Symbol}),$export($export.S,"Symbol",symbolStatics),$export($export.S+$export.F*!useNative,"Object",{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols}),$JSON&&$export($export.S+$export.F*(!useNative||buggyJSON),"JSON",{stringify:$stringify}),setToStringTag($Symbol,"Symbol"),setToStringTag(Math,"Math",!0),setToStringTag(global.JSON,"JSON",!0)},function(module,exports,__webpack_require__){var $=__webpack_require__(7),toIObject=__webpack_require__(16);module.exports=function(object,el){for(var key,O=toIObject(object),keys=$.getKeys(O),length=keys.length,index=0;length>index;)if(O[key=keys[index++]]===el)return key}},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(16),getNames=__webpack_require__(7).getNames,toString={}.toString,windowNames="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(it){try{return getNames(it)}catch(e){return windowNames.slice()}};module.exports.get=function(it){return windowNames&&"[object Window]"==toString.call(it)?getWindowNames(it):getNames(toIObject(it))}},function(module,exports,__webpack_require__){var $=__webpack_require__(7);module.exports=function(it){var keys=$.getKeys(it),getSymbols=$.getSymbols;if(getSymbols)for(var key,symbols=getSymbols(it),isEnum=$.isEnum,i=0;symbols.length>i;)isEnum.call(it,key=symbols[i++])&&keys.push(key);return keys}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(name,context,factory){"undefined"!=typeof module&&module.exports?module.exports=factory():(__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}("h337",this,function(){var HeatmapConfig={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},Store=function(){var Store=function(config){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=config.xField||config.defaultXField,this._yField=config.yField||config.defaultYField,this._valueField=config.valueField||config.defaultValueField,config.radius&&(this._cfgRadius=config.radius)},defaultRadius=HeatmapConfig.defaultRadius;return Store.prototype={_organiseData:function(dataPoint,forceRender){var x=dataPoint[this._xField],y=dataPoint[this._yField],radi=this._radi,store=this._data,max=this._max,min=this._min,value=dataPoint[this._valueField]||1,radius=dataPoint.radius||this._cfgRadius||defaultRadius;store[x]||(store[x]=[],radi[x]=[]),store[x][y]?store[x][y]+=value:(store[x][y]=value,radi[x][y]=radius);var storedVal=store[x][y];return storedVal>max?(forceRender?this.setDataMax(storedVal):this._max=storedVal,!1):storedVal<min?(forceRender?this.setDataMin(storedVal):this._min=storedVal,!1):{x:x,y:y,value:value,radius:radius,min:min,max:max}},_unOrganizeData:function(){var unorganizedData=[],data=this._data,radi=this._radi;for(var x in data)for(var y in data[x])unorganizedData.push({x:x,y:y,radius:radi[x][y],value:data[x][y]});return{min:this._min,max:this._max,data:unorganizedData}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0)for(var dataArr=arguments[0],dataLen=dataArr.length;dataLen--;)this.addData.call(this,dataArr[dataLen]);else{var organisedEntry=this._organiseData(arguments[0],!0);organisedEntry&&(0===this._data.length&&(this._min=this._max=organisedEntry.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[organisedEntry]}))}return this},setData:function(data){var dataPoints=data.data,pointsLen=dataPoints.length;this._data=[],this._radi=[];for(var i=0;i<pointsLen;i++)this._organiseData(dataPoints[i],!1);return this._max=data.max,this._min=data.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(max){return this._max=max,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(min){return this._min=min,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(coordinator){this._coordinator=coordinator},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},Store}(),Canvas2dRenderer=function(){function Canvas2dRenderer(config){var container=config.container,shadowCanvas=this.shadowCanvas=document.createElement("canvas"),canvas=this.canvas=config.canvas||document.createElement("canvas"),computed=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(config.container)||{});canvas.className="heatmap-canvas",this._width=canvas.width=shadowCanvas.width=config.width||+computed.width.replace(/px/,""),this._height=canvas.height=shadowCanvas.height=config.height||+computed.height.replace(/px/,""),this.shadowCtx=shadowCanvas.getContext("2d"),this.ctx=canvas.getContext("2d"),canvas.style.cssText=shadowCanvas.style.cssText="position:absolute;left:0;top:0;",container.style.position="relative",container.appendChild(canvas),this._palette=_getColorPalette(config),this._templates={},this._setStyles(config)}var _getColorPalette=function(config){var gradientConfig=config.gradient||config.defaultGradient,paletteCanvas=document.createElement("canvas"),paletteCtx=paletteCanvas.getContext("2d");paletteCanvas.width=256,paletteCanvas.height=1;var gradient=paletteCtx.createLinearGradient(0,0,256,1);for(var key in gradientConfig)gradient.addColorStop(key,gradientConfig[key]);return paletteCtx.fillStyle=gradient,paletteCtx.fillRect(0,0,256,1),paletteCtx.getImageData(0,0,256,1).data},_getPointTemplate=function(radius,blurFactor){var tplCanvas=document.createElement("canvas"),tplCtx=tplCanvas.getContext("2d"),x=radius,y=radius;if(tplCanvas.width=tplCanvas.height=2*radius,1==blurFactor)tplCtx.beginPath(),tplCtx.arc(x,y,radius,0,2*Math.PI,!1),tplCtx.fillStyle="rgba(0,0,0,1)",tplCtx.fill();else{var gradient=tplCtx.createRadialGradient(x,y,radius*blurFactor,x,y,radius);gradient.addColorStop(0,"rgba(0,0,0,1)"),gradient.addColorStop(1,"rgba(0,0,0,0)"),tplCtx.fillStyle=gradient,tplCtx.fillRect(0,0,2*radius,2*radius)}return tplCanvas},_prepareData=function(data){for(var renderData=[],min=data.min,max=data.max,radi=data.radi,data=data.data,xValues=Object.keys(data),xValuesLen=xValues.length;xValuesLen--;)for(var xValue=xValues[xValuesLen],yValues=Object.keys(data[xValue]),yValuesLen=yValues.length;yValuesLen--;){var yValue=yValues[yValuesLen],value=data[xValue][yValue],radius=radi[xValue][yValue];renderData.push({x:xValue,y:yValue,value:value,radius:radius})}return{min:min,max:max,data:renderData}};return Canvas2dRenderer.prototype={renderPartial:function(data){data.data.length>0&&(this._drawAlpha(data),this._colorize())},renderAll:function(data){this._clear(),data.data.length>0&&(this._drawAlpha(_prepareData(data)),this._colorize())},_updateGradient:function(config){this._palette=_getColorPalette(config)},updateConfig:function(config){config.gradient&&this._updateGradient(config),this._setStyles(config)},setDimensions:function(width,height){this._width=width,this._height=height,this.canvas.width=this.shadowCanvas.width=width,this.canvas.height=this.shadowCanvas.height=height},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(config){this._blur=0==config.blur?0:config.blur||config.defaultBlur,config.backgroundColor&&(this.canvas.style.backgroundColor=config.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=config.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=config.height||this._height,this._opacity=255*(config.opacity||0),this._maxOpacity=255*(config.maxOpacity||config.defaultMaxOpacity),this._minOpacity=255*(config.minOpacity||config.defaultMinOpacity),this._useGradientOpacity=!!config.useGradientOpacity},_drawAlpha:function(data){for(var min=this._min=data.min,max=this._max=data.max,data=data.data||[],dataLen=data.length,blur=1-this._blur;dataLen--;){var tpl,point=data[dataLen],x=point.x,y=point.y,radius=point.radius,value=Math.min(point.value,max),rectX=x-radius,rectY=y-radius,shadowCtx=this.shadowCtx;this._templates[radius]?tpl=this._templates[radius]:this._templates[radius]=tpl=_getPointTemplate(radius,blur);var templateAlpha=(value-min)/(max-min);shadowCtx.globalAlpha=templateAlpha<.01?.01:templateAlpha,shadowCtx.drawImage(tpl,rectX,rectY),rectX<this._renderBoundaries[0]&&(this._renderBoundaries[0]=rectX),rectY<this._renderBoundaries[1]&&(this._renderBoundaries[1]=rectY),rectX+2*radius>this._renderBoundaries[2]&&(this._renderBoundaries[2]=rectX+2*radius),rectY+2*radius>this._renderBoundaries[3]&&(this._renderBoundaries[3]=rectY+2*radius)}},_colorize:function(){var x=this._renderBoundaries[0],y=this._renderBoundaries[1],width=this._renderBoundaries[2]-x,height=this._renderBoundaries[3]-y,maxWidth=this._width,maxHeight=this._height,opacity=this._opacity,maxOpacity=this._maxOpacity,minOpacity=this._minOpacity,useGradientOpacity=this._useGradientOpacity;x<0&&(x=0),y<0&&(y=0),x+width>maxWidth&&(width=maxWidth-x),y+height>maxHeight&&(height=maxHeight-y);for(var img=this.shadowCtx.getImageData(x,y,width,height),imgData=img.data,len=imgData.length,palette=this._palette,i=3;i<len;i+=4){var alpha=imgData[i],offset=4*alpha;if(offset){var finalAlpha;finalAlpha=opacity>0?opacity:alpha<maxOpacity?alpha<minOpacity?minOpacity:alpha:maxOpacity,imgData[i-3]=palette[offset],imgData[i-2]=palette[offset+1],imgData[i-1]=palette[offset+2],imgData[i]=useGradientOpacity?palette[offset+3]:finalAlpha}}img.data=imgData,this.ctx.putImageData(img,x,y),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(point){var value,shadowCtx=this.shadowCtx,img=shadowCtx.getImageData(point.x,point.y,1,1),data=img.data[3],max=this._max,min=this._min;return value=Math.abs(max-min)*(data/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},Canvas2dRenderer}(),Renderer=function(){var rendererFn=!1;return"canvas2d"===HeatmapConfig.defaultRenderer&&(rendererFn=Canvas2dRenderer),rendererFn}(),Util={merge:function(){for(var merged={},argsLen=arguments.length,i=0;i<argsLen;i++){var obj=arguments[i];for(var key in obj)merged[key]=obj[key]}return merged}},Heatmap=function(){function Heatmap(){var config=this._config=Util.merge(HeatmapConfig,arguments[0]||{});if(this._coordinator=new Coordinator,config.plugin){var pluginToLoad=config.plugin;if(!HeatmapConfig.plugins[pluginToLoad])throw new Error("Plugin '"+pluginToLoad+"' not found. Maybe it was not registered.");var plugin=HeatmapConfig.plugins[pluginToLoad];this._renderer=new plugin.renderer(config),this._store=new plugin.store(config)}else this._renderer=new Renderer(config),this._store=new Store(config);_connect(this)}var Coordinator=function(){function Coordinator(){this.cStore={}}return Coordinator.prototype={on:function(evtName,callback,scope){var cStore=this.cStore;cStore[evtName]||(cStore[evtName]=[]),cStore[evtName].push(function(data){return callback.call(scope,data)})},emit:function(evtName,data){var cStore=this.cStore;if(cStore[evtName])for(var len=cStore[evtName].length,i=0;i<len;i++){var callback=cStore[evtName][i];callback(data)}}},Coordinator}(),_connect=function(scope){var renderer=scope._renderer,coordinator=scope._coordinator,store=scope._store;coordinator.on("renderpartial",renderer.renderPartial,renderer),coordinator.on("renderall",renderer.renderAll,renderer),coordinator.on("extremachange",function(data){scope._config.onExtremaChange&&scope._config.onExtremaChange({min:data.min,max:data.max,gradient:scope._config.gradient||scope._config.defaultGradient})}),store.setCoordinator(coordinator)};return Heatmap.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(config){return this._config=Util.merge(this._config,config),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(point){return this._store.getValueAt?this._store.getValueAt(point):this._renderer.getValueAt?this._renderer.getValueAt(point):null}},Heatmap}(),heatmapFactory={create:function(config){return new Heatmap(config)},register:function(pluginKey,plugin){HeatmapConfig.plugins[pluginKey]=plugin}};return heatmapFactory})}])});